Description: Fix CVE-2018-11256: PdfError info gives not-found page 0-based (and says that)
Origin: https://sourceforge.net/p/podofo/code/1938
Acked-By: Mattia Rizzolo <mattia@debian.org>
Bug: https://sourceforge.net/p/podofo/tickets/21/
Bug-Debian: https://bugs.debian.org/916583
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-11256
Last-Update: 2019-02-11

--- a/src/doc/PdfDocument.cpp
+++ b/src/doc/PdfDocument.cpp
@@ -325,6 +325,12 @@
         for(int i=0;i<rDoc.GetPageCount();i++ )
         {
             PdfPage*      pPage = rDoc.GetPage( i );
+            if (NULL == pPage)
+            {
+                std::ostringstream oss;
+                oss << "No page " << i << " (the first is 0) found.";
+                PODOFO_RAISE_ERROR_INFO( ePdfError_PageNotFound, oss.str() );
+            }
             PdfObject*    pObj  = m_vecObjects.GetObject( PdfReference( pPage->GetObject()->Reference().ObjectNumber() + difference, pPage->GetObject()->Reference().GenerationNumber() ) );
             if( pObj->IsDictionary() && pObj->GetDictionary().HasKey( "Parent" ) )
                 pObj->GetDictionary().RemoveKey( "Parent" );
