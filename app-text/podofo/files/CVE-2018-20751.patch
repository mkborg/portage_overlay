Description: CVE-2018-20751: null-pointer dereference in crop_page() of tools/podofocrop/podofocrop.cpp
Origin: https://sourceforge.net/p/podofo/code/1954
Bug: https://sourceforge.net/p/podofo/tickets/33/
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-20751
Last-Update: 2019-02-11

--- a/tools/podofocrop/podofocrop.cpp
+++ b/tools/podofocrop/podofocrop.cpp
@@ -61,6 +61,11 @@
            rCropBox.GetHeight());
     */
     rCropBox.ToVariant( var );
+    if (!pPage)
+    {
+        PODOFO_RAISE_ERROR_INFO( ePdfError_InvalidHandle,
+                                "crop_page: No page pointer given" );
+    }
     pPage->GetObject()->GetDictionary().AddKey( PdfName("MediaBox"), var );
 }
 
